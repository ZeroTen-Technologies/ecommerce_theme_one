<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shopping Cart</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        /* Custom styles for quantity input width */
        .quantity-input {
            width: 70px;
            text-align: center;
        }
        .cart-img {
            max-width: 80px;
            height: auto;
        }
        a {
            text-decoration: none;
            color: white;
        }
        .footer-link {
            text-decoration: none;
            color: #ccc;
        }
        .footer-link:hover {
            color: white;
        }
        .social-icon {
            font-size: 1.5rem;
            margin-right: 1rem;
            color: #ccc;
            transition: color 0.2s;
        }
        .social-icon:hover {
            color: #fff;
        }

    </style>
</head>
<body>

<header class="sticky-top bg-white border-bottom shadow-sm">
    <nav class="navbar navbar-expand-lg navbar-light bg-white border-bottom">
        <div class="container-fluid">
            <a class="navbar-brand fw-bold fs-4 text-primary" href="index.html">
                <i class="bi bi-bag-fill me-2"></i>ECOM STORE
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="productpage.html">Shop</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Pricing</a>
                    </li>
                </ul>
                <form class="d-flex" role="search">
                    <input class="form-control me-2" type="search" placeholder="Search products..." aria-label="Search">
                    <button class="btn btn-outline-primary" type="submit">Search</button>
                    <button class="btn btn-sm btn-outline-secondary ms-2 d-lg-inline-block" type="button"> <a href="userPage.html"> <i class="bi bi-person"></i> </a></button>
                    <button class="btn btn-sm btn-primary ms-2" type="button"> <a href="shoppingCartPage.html" style="color: white;"> <i class="bi bi-cart"></i> <span class="badge bg-danger" id="cart-counter">3</span></a></button>
                </form>
                
            </div>
        </div>
    </nav>
</header>

<section class="py-5">
    <div class="container">
        <h1 class="mb-4 fw-bold">Your Shopping Cart</h1>
        
        <div class="row">
            
            <div class="col-lg-8">
                
                <div class="table-responsive">
                    <table class="table align-middle">
                        <thead>
                            <tr>
                                <th scope="col" colspan="2">Product</th>
                                <th scope="col" class="text-center">Price</th>
                                <th scope="col" class="text-center">Quantity</th>
                                <th scope="col" class="text-end">Total</th>
                                <th scope="col"></th>
                            </tr>
                        </thead>
                        <tbody id="cart-items">
                            <tr id="empty-cart-message">
                                <td colspan="6" class="text-center text-muted py-5">
                                    Your cart is currently empty!
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <hr class="my-4">

                <div class="d-flex justify-content-between">
                    <a href="productpage.html" class="btn btn-primary" type="button">
                        <i class="bi bi-arrow-left me-2"></i> Continue Shopping
                    </a>
                    <button class="btn btn-outline-secondary" id="update-cart-btn" type="button">
                        Update Cart
                    </button>
                </div>
            </div>

            <div class="col-lg-4 mt-4 mt-lg-0">
                <div class="card shadow-sm">
                    <div class="card-body">
                        <h4 class="card-title mb-4">Cart Summary</h4>
                        
                        <ul class="list-group list-group-flush mb-3">
                            <li class="list-group-item d-flex justify-content-between">
                                <span>Subtotal:</span>
                                <span id="cart-subtotal">$0.00</span>
                            </li>
                            <li class="list-group-item d-flex justify-content-between">
                                <span>Shipping:</span>
                                <span id="cart-shipping">$0.00</span>
                            </li>
                            <li class="list-group-item d-flex justify-content-between text-success">
                                <span>Coupon Discount:</span>
                                <span id="cart-discount">-$0.00</span>
                            </li>
                            <li class="list-group-item d-flex justify-content-between fs-5 fw-bold bg-light">
                                <span>Order Total:</span>
                                <span id="cart-total">$0.00</span>
                            </li>
                        </ul>

                        <h5 class="mb-3">Apply Coupon Code</h5>
                        <div class="input-group mb-4">
                            <input type="text" class="form-control" placeholder="Enter coupon code" id="coupon-input" aria-label="Coupon code">
                            <button class="btn btn-primary" id="apply-coupon-btn" type="button">Apply</button>
                        </div>
                        
                        <div class="d-grid">
                            <a href="checkoutPage.html" id="checkout-btn" class="btn btn-primary btn-lg">
                                Proceed to Checkout <i class="bi bi-arrow-right-short"></i>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
</section>

<footer class="bg-dark text-white pt-5 pb-4">
    <div class="container">
        <div class="row g-4">
            
            <div class="col-md-3">
                <h5 class="fw-bold mb-3">Quick Links</h5>
                <ul class="list-unstyled">
                    <li><a href="#" class="footer-link">About Us</a></li>
                    <li><a href="#" class="footer-link">Contact</a></li>
                    <li><a href="#" class="footer-link">FAQs</a></li>
                    <li><a href="#" class="footer-link">Blog</a></li>
                </ul>
            </div>

            <div class="col-md-3">
                <h5 class="fw-bold mb-3">Legal & Policies</h5>
                <ul class="list-unstyled">
                    <li><a href="#" class="footer-link">Privacy Policy</a></li>
                    <li><a href="#" class="footer-link">Return Policy</a></li>
                    <li><a href="#" class="footer-link">Terms of Service</a></li>
                </ul>
            </div>

            <div class="col-md-3">
                <h5 class="fw-bold mb-3">Stay Connected</h5>
                <p>Sign up for our latest product updates.</p>
                <form>
                    <div class="input-group mb-3">
                        <input type="email" class="form-control form-control-sm" placeholder="Your Email" aria-label="Your Email" required>
                        <button class="btn btn-primary btn-sm" type="submit">Go</button>
                    </div>
                </form>
            </div>

            <div class="col-md-3">
                <h5 class="fw-bold mb-3">Get in Touch</h5>
                <p><i class="bi bi-phone me-2"></i> (555) 123-4567</p>
                <p><i class="bi bi-envelope me-2"></i> support@shopname.com</p>
                <p><i class="bi bi-geo-alt me-2"></i> 123 Ecom Lane, Retail City</p>
                <p><a href="#" class="footer-link"><i class="bi bi-chat-dots me-2"></i> Live Chat</a></p>
                
                <div class="mt-3">
                    <a href="#" class="social-icon"><i class="bi bi-facebook"></i></a>
                    <a href="#" class="social-icon"><i class="bi bi-twitter"></i></a>
                    <a href="#" class="social-icon"><i class="bi bi-instagram"></i></a>
                    <a href="#" class="social-icon"><i class="bi bi-pinterest"></i></a>
                </div>
            </div>

        </div>
        <hr class="mt-4 mb-3 border-secondary">
        <div class="text-center text-muted small">
            &copy; <span id="current-year"></span> SHOPNAME. All rights reserved.
        </div>
    </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<script>
    document.addEventListener('DOMContentLoaded', function() {
    // DOM elements
    const cartItemsContainer = document.getElementById('cart-items');
    const emptyCartMessage = document.getElementById('empty-cart-message');
    const cartSubtotalEl = document.getElementById('cart-subtotal');
    const cartTotalEl = document.getElementById('cart-total');
    const updateCartButton = document.getElementById('update-cart-btn');
    
    // Hardcoded values for simplicity (can be dynamic in a real application)
    const SHIPPING_COST = 10.00;
    const DISCOUNT_AMOUNT = 15.00; // Will only be applied if coupon is "SAVE15"

    let cart = getCartItems();
    
    // --- UTILITY FUNCTIONS ---
    
    // Fetches cart data from Local Storage
    function getCartItems() {
        const cartData = localStorage.getItem('shoppingCart');
        return cartData ? JSON.parse(cartData) : [];
    }

    // Saves cart data back to Local Storage
    function saveCartItems(newCart) {
        localStorage.setItem('shoppingCart', JSON.stringify(newCart));
        cart = newCart; // Update the local 'cart' variable
        renderCart(); // Re-render the cart table
        updateCartCounter(); // Update the counter in the header (if present)
    }

    // Updates the cart counter in the header (assumes you have a counter with ID 'cart-counter')
    function updateCartCounter() {
        const cartCounter = document.getElementById('cart-counter');
        const totalItems = cart.reduce((total, item) => total + item.quantity, 0);

        if (cartCounter) {
            cartCounter.textContent = totalItems;
        }
    }
    
    // --- MAIN RENDER FUNCTION ---
    
    function renderCart() {
        // Clear the current list of items
        cartItemsContainer.innerHTML = '';
        
        if (cart.length === 0) {
            // Show the "Cart is Empty" message
            cartItemsContainer.appendChild(emptyCartMessage);
            updateSummary(0);
            return;
        }

        // Remove the empty message if items exist
        if (emptyCartMessage) emptyCartMessage.remove(); 

        let subtotal = 0;

        cart.forEach(item => {
            const itemTotal = item.price * item.quantity;
            subtotal += itemTotal;

            // Create the table row (<tr>) element
            const row = document.createElement('tr');
            row.setAttribute('data-product-id', item.id); // For easy identification

            row.innerHTML = `
                <td style="width: 100px;">
                    <img src="${item.image}" class="img-fluid rounded cart-img" alt="${item.name}">
                </td>
                <td>
                    <h5 class="mb-0">${item.name}</h5>
                    <small class="text-muted">Price: $${item.price.toFixed(2)}</small> 
                </td>
                <td class="text-center">$${item.price.toFixed(2)}</td>
                <td class="text-center">
                    <div class="input-group input-group-sm justify-content-center" data-product-id="${item.id}">
                        <button class="btn btn-outline-secondary btn-minus" type="button">-</button>
                        <input type="text" class="form-control quantity-input text-center" value="${item.quantity}" readonly>
                        <button class="btn btn-outline-secondary btn-plus" type="button">+</button>
                    </div>
                </td>
                <td class="text-end fw-bold item-total-price">$${itemTotal.toFixed(2)}</td>
                <td>
                    <button class="btn btn-sm btn-outline-danger btn-remove" type="button" title="Remove Item">
                        <i class="bi bi-x-lg"></i>
                    </button>
                </td>
            `;

            cartItemsContainer.appendChild(row);
        });

        updateSummary(subtotal);
        attachEventListeners();
    }
    
    // --- EVENT LISTENERS FOR CART INTERACTION ---
    
    function attachEventListeners() {
        // 1. Remove Item Button
        document.querySelectorAll('.btn-remove').forEach(button => {
            button.addEventListener('click', function() {
                const row = this.closest('tr');
                const productId = row.getAttribute('data-product-id');
                
                // Filter the cart to remove the item
                const newCart = cart.filter(item => item.id !== productId);
                saveCartItems(newCart);
            });
        });

        // 2. Quantity Change Buttons (+ and -)
        document.querySelectorAll('.input-group button').forEach(button => {
            button.addEventListener('click', function() {
                const inputGroup = this.closest('.input-group');
                const productId = inputGroup.getAttribute('data-product-id');
                const quantityInput = inputGroup.querySelector('.quantity-input');
                let newQuantity = parseInt(quantityInput.value);

                if (this.classList.contains('btn-plus')) {
                    newQuantity += 1;
                } else if (this.classList.contains('btn-minus') && newQuantity > 1) {
                    newQuantity -= 1;
                }
                
                // Find the item in the cart and update its quantity
                const itemIndex = cart.findIndex(item => item.id === productId);
                if (itemIndex > -1) {
                    cart[itemIndex].quantity = newQuantity;
                }

                saveCartItems(cart);
            });
        });
        
        // 3. Update Cart Button (Re-renders, mainly here for structure)
        updateCartButton.addEventListener('click', function() {
             renderCart();
             // Optionally add a notification that the cart has been updated
             console.log("Cart updated!");
        });
        
        // 4. Coupon Apply Button
        document.getElementById('apply-coupon-btn').addEventListener('click', function() {
            // Re-render to recalculate with the coupon
            updateSummary(calculateSubtotal(), document.getElementById('coupon-input').value.trim());
        });
    }

    // --- SUMMARY CALCULATION ---

    function calculateSubtotal() {
        return cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
    }
    
    function updateSummary(subtotal, couponCode = '') {
        // 1. Subtotal
        cartSubtotalEl.textContent = `$${subtotal.toFixed(2)}`;
        
        // 2. Shipping
        const shippingEl = document.getElementById('cart-shipping');
        shippingEl.textContent = `$${SHIPPING_COST.toFixed(2)}`;
        
        // 3. Discount (Simple coupon logic)
        let discount = 0;
        const discountEl = document.getElementById('cart-discount');

        if (couponCode.toUpperCase() === 'SAVE15') {
            discount = DISCOUNT_AMOUNT;
            discountEl.textContent = `-$${discount.toFixed(2)}`;
            discountEl.closest('li').classList.add('text-success'); // Highlight if applied
        } else {
            discountEl.textContent = `-$${discount.toFixed(2)}`;
            discountEl.closest('li').classList.remove('text-success');
        }

        // 4. Total
        let total = subtotal + SHIPPING_COST - discount;
        cartTotalEl.textContent = `$${total.toFixed(2)}`;
    }


    // Initial load: Render the cart when the page loads
    renderCart();
    updateCartCounter();
});
</script>

</body>
</html>